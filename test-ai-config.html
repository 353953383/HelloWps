<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>AI配置测试</title>
    <script type="text/javascript" src="./js/server-config.js"></script>
    <script type="text/javascript" src="./js/aiHelper/aiapi-standard.js"></script>
    <script type="text/javascript" src="./js/aiHelper/api-config.js"></script>
    <script type="text/javascript" src="./js/aiHelper/aiInterface.js"></script>
</head>
<body>
    <h1>AI配置测试</h1>
    <div id="result"></div>

    <script>
        window.addEventListener('load', function() {
            var result = document.getElementById('result');
            
            // 显示当前配置
            result.innerHTML += '<h2>当前配置</h2>';
            result.innerHTML += '<p>AI_CONFIG_TYPE: ' + window.AI_CONFIG_TYPE + '</p>';
            result.innerHTML += '<p>是否定义了CURRENT_AI_CONFIG: ' + !!window.CURRENT_AI_CONFIG + '</p>';
            
            if (window.CURRENT_AI_CONFIG) {
                result.innerHTML += '<p>当前配置详情:</p><ul>';
                for (var key in window.CURRENT_AI_CONFIG) {
                    result.innerHTML += '<li>' + key + ': ' + window.CURRENT_AI_CONFIG[key] + '</li>';
                }
                result.innerHTML += '</ul>';
            }
            
            // 测试AI接口
            result.innerHTML += '<h2>AI接口测试</h2>';
            try {
                var aiInterface = new AIInterface();
                result.innerHTML += '<p>✅ AIInterface 创建成功</p>';
                result.innerHTML += '<p>API端点: ' + aiInterface.apiEndpoint + '</p>';
                result.innerHTML += '<p>模型名称: ' + aiInterface.modelName + '</p>';
            } catch (error) {
                result.innerHTML += '<p>❌ AIInterface 创建失败: ' + error.message + '</p>';
            }
            
            // 测试标准API
            result.innerHTML += '<h2>标准API测试</h2>';
            try {
                if (window.CURRENT_AI_CONFIG) {
                    var standardApi = new aiapiStandard(window.CURRENT_AI_CONFIG);
                    result.innerHTML += '<p>✅ 标准API 创建成功</p>';
                    result.innerHTML += '<p>API端点: ' + standardApi.endpoint + '</p>';
                    result.innerHTML += '<p>模型名称: ' + standardApi.model + '</p>';
                } else {
                    result.innerHTML += '<p>❌ 无法创建标准API: CURRENT_AI_CONFIG 未定义</p>';
                }
            } catch (error) {
                result.innerHTML += '<p>❌ 标准API 创建失败: ' + error.message + '</p>';
            }
            
            // 测试配置管理器
            result.innerHTML += '<h2>配置管理器测试</h2>';
            try {
                var configManager = new ApiConfigManager();
                var status = configManager.getConfigStatus();
                result.innerHTML += '<p>✅ 配置管理器创建成功</p>';
                result.innerHTML += '<p>配置是否有效: ' + status.isConfigured + '</p>';
                if (status.config) {
                    result.innerHTML += '<p>配置详情:</p><ul>';
                    for (var key in status.config) {
                        result.innerHTML += '<li>' + key + ': ' + status.config[key] + '</li>';
                    }
                    result.innerHTML += '</ul>';
                }
            } catch (error) {
                result.innerHTML += '<p>❌ 配置管理器测试失败: ' + error.message + '</p>';
            }
        });
    </script>
</body>
</html>